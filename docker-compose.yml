services:
  bot:
    build: .
    container_name: preservefood-bugbot
    restart: unless-stopped
    ports:
      - "8087:8087"
    volumes:
      - bot-data:/app/data
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - BUG_CHANNEL_ID=${BUG_CHANNEL_ID}
      - WEBHOOK_SECRET=${WEBHOOK_SECRET}
      - WEBHOOK_PORT=${WEBHOOK_PORT:-8087}
      - WEBHOOK_HOST=${WEBHOOK_HOST:-0.0.0.0}
      - DATABASE_PATH=${DATABASE_PATH:-data/bugs.db}
      - DEVELOPER_ROLE_NAME=${DEVELOPER_ROLE_NAME:-Developer}
      - SIGNATURE_HEADER_NAME=${SIGNATURE_HEADER_NAME:-X-Webhook-Signature}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - ANTHROPIC_MODEL=${ANTHROPIC_MODEL:-claude-haiku-4-5-20251001}
      - AI_MAX_TOKENS=${AI_MAX_TOKENS:-1024}
      - GITHUB_APP_ID=${GITHUB_APP_ID}
      - GITHUB_PRIVATE_KEY=${GITHUB_PRIVATE_KEY}
      - GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
      - GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
      - GITHUB_WEBHOOK_SECRET=${GITHUB_WEBHOOK_SECRET}
      - GITHUB_APP_NAME=${GITHUB_APP_NAME}
      - GITHUB_PAT=${GITHUB_PAT}
      - COPILOT_SESSION_TIMEOUT=${COPILOT_SESSION_TIMEOUT:-3600}  
      - CODE_FIX_MODE=${CODE_FIX_MODE:-anthropic}
volumes:
  bot-data:
